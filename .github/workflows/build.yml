name: Build APK - Nuevos Temas Oscuros

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        distribution: 'zulu'
        java-version: '17'

    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.35.1'
        channel: 'stable'

    - name: Install dependencies
      run: flutter pub get

    - name: Build APK
      run: flutter build apk --release --build-name="NUEVOS-TEMAS-v1.0.19" --build-number=19

    - name: Rename APK
      run: |
        mkdir -p apk_outputs
        cp build/app/outputs/flutter-apk/app-release.apk apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk

    - name: Upload APK artifact
      uses: actions/upload-artifact@v4
      with:
        name: Diario-NUEVOS-TEMAS-v1.0.19
        path: apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk
        retention-days: 30

    - name: Create Release
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      uses: softprops/action-gh-release@v1
      with:
        tag_name: v1.0.19-nuevos-temas
        name: Diario Personal - Nuevos Temas Oscuros v1.0.19
        body: |
          ğŸ¨ **NUEVOS TEMAS OSCUROS ESPECTACULARES** - Â¡8 TEMAS ADICIONALES!
          
          ## âœ¨ **TEMAS AÃ‘ADIDOS:**
          
          ### ğŸŒ™ **Nuevos temas disponibles:**
          - ğŸŒŸ **NeÃ³n Oscuro** - Colores brillantes sobre fondo negro
          - ğŸ¤– **Cyberpunk** - Estilo futurista amarillo/rojo
          - ğŸŒŠ **Azul Medianoche** - Tonos azules profundos
          - ğŸŒ² **Bosque** - Verde oscuro y natural
          - ğŸ§› **Vampiro** - Rojo sangre y pÃºrpura
          - ğŸ’š **Matrix** - Verde sobre negro estilo Matrix
          - ğŸ† **Dracula** - El clÃ¡sico tema oscuro (mejorado)
          - ğŸŒ‘ **Tema Oscuro** - Oscuro tradicional
          
          ### ğŸ¯ **FUNCIONES COMPLETAS:**
          - ğŸ¤ **Dictado de voz perfecto** (control 100% manual)
          - ğŸ—‘ï¸ **EliminaciÃ³n sin errores**
          - ğŸ“ **Importar/exportar entradas**
          - ğŸ” **Sistema de contraseÃ±as**
          - ğŸ” **Zoom en pantalla**
          - âœï¸ **Editar entradas guardadas**
          - ğŸ¨ **9 TEMAS DIFERENTES** (1 claro + 8 oscuros)
          
          ### ğŸ–¼ï¸ **CaracterÃ­sticas visuales:**
          - Paletas de colores cuidadosamente diseÃ±adas
          - Contrastes optimizados para facilidad de lectura
          - Efectos visuales Ãºnicos en cada tema
          - Bordes y sombras personalizadas
          
          ### ğŸ“± **INSTALACIÃ“N:**
          Descarga `Diario-NUEVOS-TEMAS-v1.0.19.apk` e instÃ¡lala.
          
          **Â¡Disfruta de la variedad de temas oscuros espectaculares!** ğŸŒŸ
        files: |
          apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}