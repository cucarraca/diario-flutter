name: Build APK - Nuevos Temas Oscuros

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        distribution: 'zulu'
        java-version: '17'

    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.35.1'
        channel: 'stable'

    - name: Install dependencies
      run: flutter pub get

    - name: Build APK
      run: flutter build apk --release --build-name="NUEVOS-TEMAS-v1.0.19" --build-number=19

    - name: Rename APK
      run: |
        mkdir -p apk_outputs
        cp build/app/outputs/flutter-apk/app-release.apk apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk

    - name: Upload APK artifact
      uses: actions/upload-artifact@v4
      with:
        name: Diario-NUEVOS-TEMAS-v1.0.19
        path: apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk
        retention-days: 30

    - name: Create Release
      if: github.event_name == 'push' && github.ref == 'refs/heads/main'
      uses: softprops/action-gh-release@v1
      with:
        tag_name: v1.0.19-nuevos-temas
        name: Diario Personal - Nuevos Temas Oscuros v1.0.19
        body: |
          🎨 **NUEVOS TEMAS OSCUROS ESPECTACULARES** - ¡8 TEMAS ADICIONALES!
          
          ## ✨ **TEMAS AÑADIDOS:**
          
          ### 🌙 **Nuevos temas disponibles:**
          - 🌟 **Neón Oscuro** - Colores brillantes sobre fondo negro
          - 🤖 **Cyberpunk** - Estilo futurista amarillo/rojo
          - 🌊 **Azul Medianoche** - Tonos azules profundos
          - 🌲 **Bosque** - Verde oscuro y natural
          - 🧛 **Vampiro** - Rojo sangre y púrpura
          - 💚 **Matrix** - Verde sobre negro estilo Matrix
          - 🎆 **Dracula** - El clásico tema oscuro (mejorado)
          - 🌑 **Tema Oscuro** - Oscuro tradicional
          
          ### 🎯 **FUNCIONES COMPLETAS:**
          - 🎤 **Dictado de voz perfecto** (control 100% manual)
          - 🗑️ **Eliminación sin errores**
          - 📁 **Importar/exportar entradas**
          - 🔐 **Sistema de contraseñas**
          - 🔍 **Zoom en pantalla**
          - ✏️ **Editar entradas guardadas**
          - 🎨 **9 TEMAS DIFERENTES** (1 claro + 8 oscuros)
          
          ### 🖼️ **Características visuales:**
          - Paletas de colores cuidadosamente diseñadas
          - Contrastes optimizados para facilidad de lectura
          - Efectos visuales únicos en cada tema
          - Bordes y sombras personalizadas
          
          ### 📱 **INSTALACIÓN:**
          Descarga `Diario-NUEVOS-TEMAS-v1.0.19.apk` e instálala.
          
          **¡Disfruta de la variedad de temas oscuros espectaculares!** 🌟
        files: |
          apk_outputs/Diario-NUEVOS-TEMAS-v1.0.19.apk
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}